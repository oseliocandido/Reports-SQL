
<!-- saved from url=(0103)file:///G:/Meu%20Drive/Dados/Trabalho/Carreira/Portf%C3%B3lio/GitHub/Sales%20Frequency/M%20Queries.html -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><style>body {
      color: #000000;
      background-color: #FFFFFF;
      font-size: 24;
      font-family: Serif;
      font-weight: bold;
      font-style: italic;
      }
      h1, h2, h3, h4, h5, h6 {
      color: #000000;
      background-color: #FFFFFF;
      font-size: 24;
      font-family: Serif;
      font-weight: bold;
      font-style: italic;
      }
      table, pre {
      color: #000000;
      background-color: #FFFFFF;
      font-size: 16;
      font-family: Serif;
      font-weight: normal;
      font-style: normal;
      }
      ul, #myUL {
      list-style-type: none;
      }
      #myUL {
      margin: 0;
      padding: 0;
      }
      .caret, .dropDownCaret {
      cursor: pointer;
      }
      .caret::before {
      content: "\25B6";
      color: black;
      display: inline - block;
      margin - right: 6px;
      }
      .dropDownCaret::before {
      content: "\25BC";
      color: black;
      display: inline - block;
      margin - right: 6px;
      float: right;
      }
      .nested {
      display: none;
      }
      .active {
      display: block;
      }
   </style>
   </head><body>
      <div>Power BI Documentation</div>
      <div>
      Generated by <a href="http://radacad.com/power-bi-helper">Power BI Helper</a> (Copyright © <a href="http://radacad.com/">RADACAD</a>).<br><br><br>Sales Frequency Report
      <hr>
      </div>M Queries
      <br><br>
      <table border="1px" cellpadding="1" cellspacing="1">
         <tbody><tr><td>Name</td><td>QueryDefinition</td></tr><tr><td>dim Calendar-650572d9-797e-4dd0-9903-0e7734736fe0</td><td><font color="blue">let</font><br><br>    Fonte
= <font color="purple">List.Dates</font>(#<font color="blue">date</font>(2003, 01, 01),7300, #duration(1,0,0,0)),<br><br>    #<font color="red">"Convertido para Tabela"</font> = <font color="purple">Table.FromList</font>(Fonte, <font color="purple">Splitter.SplitByNothing</font>(), <font color="blue">null</font>, <font color="blue">null</font>, <font color="purple">ExtraValues.Error</font>),<br><br>    #<font color="red">"Colunas Renomeadas"</font> = <font color="purple">Table.RenameColumns</font>(#<font color="red">"Convertido para Tabela"</font>,{{<font color="red">"Column1"</font>, <font color="red">"Calendario"</font>}}),<br><br>    #<font color="red">"Linhas Classificadas"</font> = <font color="purple">Table.Sort</font>(#<font color="red">"Colunas Renomeadas"</font>,{{<font color="red">"Calendario"</font>, <font color="purple">Order.Ascending</font>}}),<br><br>    #<font color="red">"Ano Inserido"</font> = <font color="purple">Table.AddColumn</font>(#<font color="red">"Linhas Classificadas"</font>, <font color="red">"Ano"</font>, each <font color="purple">Date.Year</font>([Calendario]), <font color="purple">Int64.Type</font>),<br><br>    #<font color="red">"Mês Inserido"</font> = <font color="purple">Table.AddColumn</font>(#<font color="red">"Ano Inserido"</font>, <font color="red">"Mês"</font>, each <font color="purple">Date.Month</font>([Calendario]), <font color="purple">Int64.Type</font>),<br><br>    #<font color="red">"Nome do Mês Inserido"</font> = <font color="purple">Table.AddColumn</font>(#<font color="red">"Mês Inserido"</font>, <font color="red">"Nome do Mês"</font>, each <font color="purple">Date.Month</font>Name([Calendario]), <font color="blue">type</font> <font color="blue">text</font>),<br><br>    #<font color="red">"Trimestre Inserido"</font> = <font color="purple">Table.AddColumn</font>(#<font color="red">"Nome do Mês Inserido"</font>, <font color="red">"Trimestre"</font>, each <font color="purple">Date.QuarterOfYear</font>([Calendario]), <font color="purple">Int64.Type</font>),<br><br>    #<font color="red">"Semana do Ano Inserida"</font> = <font color="purple">Table.AddColumn</font>(#<font color="red">"Trimestre Inserido"</font>, <font color="red">"Semana do Ano"</font>, each <font color="purple">Date.WeekOfYear</font>([Calendario]), <font color="purple">Int64.Type</font>),<br><br>    #<font color="red">"Nome do Dia Inserido"</font> = <font color="purple">Table.AddColumn</font>(#<font color="red">"Semana do Ano Inserida"</font>, <font color="red">"Nome do Dia"</font>, each <font color="purple">Date.Day</font>OfWeekName([Calendario]), <font color="blue">type</font> <font color="blue">text</font>),<br><br>    #<font color="red">"Semana do Mês Inserida"</font> = <font color="purple">Table.AddColumn</font>(#<font color="red">"Nome do Dia Inserido"</font>, <font color="red">"Semana do Mês"</font>, each <font color="purple">Date.WeekOfMonth</font>([Calendario]), <font color="purple">Int64.Type</font>),<br><br>    #<font color="red">"Prefixo Inserido"</font> = <font color="purple">Table.AddColumn</font>(#<font color="red">"Semana do Mês Inserida"</font>, <font color="red">"Nome do Trimestre"</font>, each <font color="red">"Trim "</font> &amp; <font color="purple">Text.From</font>([Trimestre], "pt-BR"), <font color="blue">type</font> <font color="blue">text</font>),<br><br>    #<font color="red">"Prefixo Inserido1"</font> = <font color="purple">Table.AddColumn</font>(#<font color="red">"Prefixo Inserido"</font>, <font color="red">"Nome Semana Ano"</font>, each <font color="red">"Sem "</font> &amp; <font color="purple">Text.From</font>([Semana do Ano], "pt-BR"), <font color="blue">type</font> <font color="blue">text</font>),<br><br>    #<font color="red">"Prefixo Inserido2"</font> = <font color="purple">Table.AddColumn</font>(#<font color="red">"Prefixo Inserido1"</font>, <font color="red">"Nome Semana Mes"</font>, each <font color="red">"Sem "</font> &amp; <font color="purple">Text.From</font>([Semana do Mês], "pt-BR"), <font color="blue">type</font> <font color="blue">text</font>),<br><br>    #<font color="red">"Dia Inserido"</font> = <font color="purple">Table.AddColumn</font>(#<font color="red">"Prefixo Inserido2"</font>, <font color="red">"Dia do Mês"</font>, each <font color="purple">Date.Day</font>([Calendario]), <font color="purple">Int64.Type</font>),<br><br>    #<font color="red">"Changed Type"</font> = <font color="purple">Table.TransformColumnTypes</font>(#<font color="red">"Dia Inserido"</font>,{{<font color="red">"Calendario"</font>, <font color="blue">type</font> <font color="blue">date</font>}})<br><br><font color="blue">in</font><br><br>    #<font color="red">"Changed Type"</font></td></tr><tr><td>Measures-852c24c2-39d5-4368-a28c-17f1b3504095</td><td><font color="blue">let</font><br><br>    Fonte = <font color="purple">Table.FromRows</font>(<font color="purple">Json.Document</font>(<font color="purple">Binary.Decompress</font>(<font color="purple">Binary.From</font>Text(<font color="red">"i45WMlKKjQUA"</font>, <font color="purple">BinaryEncoding.Base64</font>), <font color="purple">Compression.Deflate</font>)), <font color="blue">let</font> _t = ((<font color="blue">type</font> nullable <font color="blue">text</font>) meta [Serialized.Text = <font color="blue">true</font>]) <font color="blue">in</font> <font color="blue">type</font> table [a = _t]),<br><br>    #<font color="red">"Colunas Removidas"</font> = <font color="purple">Table.RemoveColumns</font>(Fonte,{<font color="red">"a"</font>})<br><br><font color="blue">in</font><br><br>    #<font color="red">"Colunas Removidas"</font></td></tr><tr><td>dim Products-7c308b39-a914-480d-8d13-523374485da2</td><td><font color="blue">let</font><br><br>    Fonte = <font color="purple">Oracle.Database</font>(<font color="red">"prod"</font>, [Query="-- Lista dos fornecedores do varejo#(lf)#(lf)WITH LISTA_FORNECEDORES AS #(lf)#(lf)( SELECT P.CODFORNEC #(lf)  FROM PCPRODUT P #(lf)  WHERE #(lf)  P.CODFORNEC IN #(lf)(1602,#(lf)2278,#(lf)3486,#(lf)2007,#(lf)1973,#(lf)4207,#(lf)165,#(lf)3782,#(lf)2293,#(lf)3501,#(lf)31,#(lf)1577,#(lf)3797,#(lf)3515,#(lf)2632,#(lf)2130,#(lf)4290,#(lf)1622,#(lf)1531,#(lf)1509,#(lf)3122,#(lf)373,#(lf)83,#(lf)4073,#(lf)4132,#(lf)5,#(lf)393,#(lf)3319,#(lf)247,#(lf)1548,#(lf)2705,#(lf)197,#(lf)4067,#(lf)1984,#(lf)4296,#(lf)4280,#(lf)4283,#(lf)4151)#(lf))#(lf)#(lf)#(lf)SELECT #(lf)       F.CODFORNEC,#(lf)       F.FORNECEDOR,#(lf)       F.CODFORNEC ||' - ' || F.FORNECEDOR AS CONCAT_FORNECEDOR,#(lf)       SEC.CODSEC,#(lf)       SEC.DESCRICAO SECAO,#(lf)       SEC.CODSEC ||' - ' || SEC.DESCRICAO AS CONCAT_SECAO ,#(lf)       P.CODPROD,#(lf)       P.DESCRICAO Produto,#(lf)       P.CODPROD ||' - ' || P.DESCRICAO AS CONCAT_PRODUTO,#(lf)       P.OBS2 ATIVO,#(lf)       CASE WHEN P.CODFORNEC IN (SELECT * FROM LISTA_FORNECEDORES) THEN 'Varejo'#(lf)             ELSE 'Outros'END Tipo_Fornecedor#(lf)                  #(lf)FROM PCPRODUT P #(lf)#(lf)INNER JOIN PCFORNEC F#(lf)ON P.CODFORNEC = F.CODFORNEC#(lf)#(lf)INNER JOIN PCSECAO SEC#(lf)ON P.CODSEC = SEC.CODSEC"]),<br><br>    #<font color="red">"Tipo Alterado"</font> = <font color="purple">Table.TransformColumnTypes</font>(Fonte,{{<font color="red">"CODFORNEC"</font>, <font color="purple">Int64.Type</font>}, {<font color="red">"CODSEC"</font>, <font color="purple">Int64.Type</font>}, {<font color="red">"CODPROD"</font>, <font color="purple">Int64.Type</font>}})<br><br><font color="blue">in</font><br><br>    #<font color="red">"Tipo Alterado"</font></td></tr><tr><td>fato Orders-49ef79dc-c102-46e3-9861-22904f51dfac</td><td><font color="blue">let</font><br><br>    Fonte  = <font color="purple">Oracle.Database</font>(<font color="red">"prod"</font>, [Query="-- Carteira#(lf)SELECT #(lf)      TUDO.CONDVENDA,#(lf)      TUDO.CODCLI,#(lf)      TUDO.CODPROD,#(lf)      --TUDO.VLTOTAL,#(lf)      TUDO.DT_PEDIDO#(lf)      --TUDO.COD_RCA,#(lf)      --TUDO.COD_SUPERVISOR_VENDA,#(lf)      --U.CODUSUR ||' - ' || U.NOME AS CONCAT_RCA_VENDA,#(lf)     -- S.CODSUPERVISOR ||' - ' || S.NOME AS CONCAT_SUPERV_VENDA,#(lf)--      CASE WHEN S.CODSUPERVISOR IN (9111,9114,9116,9119,9121,9122,9124,9125,9131,9132,9137,9141,9142,9143,9145,9146,9147) THEN 'G.C Varejo'#(lf)--         WHEN S.CODSUPERVISOR IN (9135) THEN 'G.A Regionais'#(lf)--         WHEN S.CODSUPERVISOR IN (1) THEN 'G.A Atacado'#(lf)--         WHEN S.CODSUPERVISOR IN (9107) THEN 'G.A Unipar'#(lf)--         ELSE 'Outros' END AS Gerencia#(lf)#(lf)FROM #(lf)(#(lf)SELECT#(lf)  --PED.NUMNOTA,#(lf)  --PED.NUMPED,#(lf)  PED.CONDVENDA,#(lf)  PED.CODCLI,#(lf) -- P.CODFORNEC,#(lf)  --P.CODSEC,#(lf)  I.CODPROD,#(lf)  --I.QT,#(lf)  --TO_NUMBER(DECODE(P.TIPOMERC,'CB','0',I.pvenda)) AS PVENDA,#(lf)  --TO_NUMBER(DECODE(P.TIPOMERC,'CB','0',I.QT*I.pvenda)) AS VLTOTAL,#(lf)  --PED.CODUSUR AS COD_RCA,#(lf)  --PED.CODSUPERVISOR AS COD_SUPERVISOR_VENDA,#(lf)  PED.data as DT_PEDIDO#(lf)  --PED.dtfat AS DT_FATURAMENTO,#(lf)  --rede.codrede#(lf)#(lf)FROM#(lf)  PCCLIENT C, PCPRODUT P, PCUSUARI U, PCSUPERV S, PCATIVI A, PCPEDC PED, PCPEDI I, PCPRACA PR, PCFORNEC F, PCREGIAO R, PCSECAO SEC, PCTABPRCLI TABP,#(lf)  pcredecliente rede,PCCIDADE CD #(lf)WHERE#(lf)#(lf)  P.CODPROD(+) = I.CODPROD#(lf)  AND C.CODREDE=REDE.CODREDE(+) #(lf)  AND TABP.CODCLI(+) = C.CODCLI#(lf)  AND C.CODCIDADE=CD.CODCIDADE#(lf)  AND U.CODUSUR = PED.CODUSUR#(lf)  AND I.NUMPED = PED.NUMPED#(lf)  AND U.CODSUPERVISOR = S.CODSUPERVISOR#(lf)  AND A.CODATIV = C.CODATV1#(lf)  AND PED.CODCLI = C.CODCLI#(lf)  AND C.CODPRACA = PR.CODPRACA#(lf)  AND P.CODFORNEC = F.CODFORNEC#(lf)  AND C.NUMREGIAOCLI = R.NUMREGIAO(+)#(lf)  AND P.CODSEC = SEC.CODSEC#(lf)  --AND PED.CONDVENDA = 1#(lf)  AND PED.CONDVENDA IN (1,5,7,10,11)#(lf)  AND PED.dtcancel IS NULL#(lf)  AND PED.DATA  &gt;= to_date('01/01/2019','DD/MM/YYYY')#(lf)  AND I.DATA  &gt;= to_date('01/01/2019','DD/MM/YYYY')#(lf)#(lf)UNION ALL#(lf)#(lf)SELECT#(lf)  --PED.NUMNOTA,#(lf) -- PED.NUMPED,#(lf)  PED.CONDVENDA,#(lf)  PED.CODCLI,#(lf)  --P.CODFORNEC,#(lf)  --P.CODSEC,#(lf)  CB.CODPRODMP,#(lf)  --CB.QTMP,#(lf)  --TO_NUMBER(DECODE(P.TIPOMERC,'CB','0',CB.pvenda)) AS PVENDA,#(lf) -- TO_NUMBER(DECODE(P.TIPOMERC,'CB','0',CB.QTMP*CB.pvenda)) AS VLTOTAL,#(lf) -- PED.CODUSUR AS COD_RCA,#(lf) -- PED.CODSUPERVISOR AS COD_SUPERVISOR_VENDA,#(lf)  PED.data as DT_PEDIDO#(lf)  --PED.dtfat AS DT_FATURAMENTO,#(lf)  --rede.codrede#(lf)  #(lf)FROM#(lf)  PCCLIENT C, PCPRODUT P, PCUSUARI U, PCSUPERV S, PCATIVI A, PCPEDC PED,#(lf)  PCPRACA PR, PCFORNEC F, PCREGIAO R, PCSECAO SEC, PCPEDICESTA CB, PCTABPRCLI TABP,#(lf)  pcredecliente rede,PCCIDADE CD#(lf)WHERE#(lf)#(lf)  U.CODUSUR = PED.CODUSUR#(lf)  AND C.CODREDE=REDE.CODREDE(+)#(lf)  AND TABP.CODCLI(+) = C.CODCLI#(lf)  AND C.CODCIDADE=CD.CODCIDADE#(lf)  AND PED.NUMPED=CB.NUMPED#(lf)  AND P.CODPROD(+)=CB.CODPRODMP#(lf)  AND U.CODSUPERVISOR = S.CODSUPERVISOR#(lf)  AND A.CODATIV = C.CODATV1#(lf)  AND PED.CODCLI = C.CODCLI#(lf)  AND C.CODPRACA = PR.CODPRACA#(lf)  AND P.CODFORNEC = F.CODFORNEC#(lf)  AND C.NUMREGIAOCLI = R.NUMREGIAO(+)#(lf)  AND P.CODSEC = SEC.CODSEC#(lf)  --AND PED.CONDVENDA = 1#(lf)  AND PED.CONDVENDA IN (1,5,7,10,11)#(lf)  AND PED.dtcancel IS NULL#(lf)  AND PED.DATA  &gt;= to_date('01/01/2019','DD/MM/YYYY')#(lf)  #(lf)UNION ALL#(lf)#(lf)SELECT#(lf)  --M.NUMNOTA,#(lf)  --M.NUMPED,#(lf)  0 CONDVENDA,#(lf)  M.CODCLI,#(lf)  --P.CODFORNEC,#(lf)  --P.CODSEC,#(lf)  M.CODPROD,#(lf)  --DECODE(M.STATUS,'A',M.QTCONT,M.QT)*(-1) QT,#(lf)  --DECODE(M.STATUS,'AB',NVL(M.PUNIT,0),NVL(M.PUNITCONT,0))*(-1) AS PVENDA,#(lf)  --DECODE(M.STATUS,'AB',(M.QT * NVL(M.PUNIT,0)),(M.QTCONT * NVL(M.PUNITCONT,0)))*(-1) AS VLTOTAL,#(lf)  --M.CODUSUR AS COD_RCA,#(lf)  --U.CODSUPERVISOR AS COD_SUPERVISOR_VENDA,#(lf)  M.DTMOV as DT_PEDIDO#(lf) -- M.DTMOV AS DT_FATURAMENTO,#(lf)  --rede.codrede#(lf)#(lf)FROM#(lf)  PCCLIENT C, PCPRODUT P, PCUSUARI U, PCSUPERV S, PCATIVI A, PCMOV M, PCPRACA PR, PCFORNEC F, PCREGIAO R, PCSECAO SEC, PCTABPRCLI TABP,#(lf)  pcredecliente rede,PCCIDADE CD#(lf)WHERE#(lf)  P.CODPROD(+) = M.CODPROD#(lf)  AND C.CODREDE=REDE.CODREDE(+)#(lf)  AND TABP.CODCLI(+) = C.CODCLI#(lf)  AND C.CODCIDADE=CD.CODCIDADE#(lf)  AND U.CODUSUR = M.CODUSUR#(lf)  AND U.CODSUPERVISOR = S.CODSUPERVISOR#(lf)  AND A.CODATIV = C.CODATV1#(lf)  AND M.CODCLI = C.CODCLI#(lf)  AND C.CODPRACA = PR.CODPRACA#(lf)  AND P.CODFORNEC = F.CODFORNEC#(lf)  AND C.NUMREGIAOCLI = R.NUMREGIAO(+)#(lf)  AND P.CODSEC = SEC.CODSEC#(lf)  AND M.CODOPER = 'ED'#(lf)  AND M.CODDEVOL&lt;&gt;123#(lf)  AND M.dtcancel IS NULL#(lf)  AND M.DTMOV &gt;= to_date('01/01/2019','DD/MM/YYYY')#(lf)  ) TUDO#(lf)  #(lf) #(lf)--  LEFT JOIN PCSUPERV S ON #(lf)--  TUDO.COD_SUPERVISOR_VENDA =S.CODSUPERVISOR#(lf)--  #(lf)--  LEFT JOIN  PCUSUARI U ON#(lf)--  TUDO.COD_RCA = U.CODUSUR #(lf)--  #(lf)  #(lf)  #(lf)  #(lf)  #(lf) -- WHERE #(lf)  --TUDO.COD_SUPERVISOR_VENDA IN #(lf)#(lf)--(SELECT W.CODSUPERVISOR FROM DSL.PCSUPERV W #(lf)--WHERE W.NOME LIKE '%EQUIPE%'#(lf)--AND W.CODSUPERVISOR NOT IN (9140,9136,9123,9133,9130))"]),<br><br>    #<font color="red">"FilteredRows"</font> = <font color="purple">Table.SelectRows</font>(Fonte, <font color="blue">each</font> [DT_PEDIDO] &gt;= RangeStart and [DT_PEDIDO]  &lt; RangeEnd)<br><br><font color="blue">in</font><br><br>    #<font color="red">"FilteredRows"</font></td></tr><tr><td>fato Potential Customers-de8a9e6c-eebd-4cf9-85e2-11428b19dd53</td><td><font color="blue">let</font><br><br>    Fonte = <font color="purple">Oracle.Database</font>(<font color="red">"prod"</font>,Query="SELECT VALOR.*,GERENCIA.Gerencia FROM #(lf)(#(lf)SELECT#(lf) C.CODCLI AS CODCLI,#(lf) C.CLIENTE,#(lf) --C.CEPENT AS CEP,#(lf) --C.ENDERENT AS ENDERECO,#(lf) --C.BAIRROENT AS BAIRRO,#(lf) C.MUNICENT AS MUNICIPIO,#(lf) --C.CGCENT AS CNPJ,#(lf) --C.IEENT AS IE,#(lf) C.BLOQUEIO,#(lf) C.OBS AS ""MOTIVO BLOQUEIO"",#(lf) C.CODUSUR1 AS CODRCA1,#(lf) U.NOME AS RCA,#(lf) S.CODSUPERVISOR,#(lf) S.NOME AS SUPERVISOR,#(lf) --C.FANTASIA,#(lf) I.RAMO,#(lf) --C.LIMCRED,#(lf) C.DTULTCOMP,#(lf) C.ESTENT,#(lf) C.DTBLOQ ,#(lf) C.DTCADASTRO,#(lf)-- C.DTEXCLUSAO #(lf) --C.DTPRIMCOMPRA#(lf)FROM#(lf) PCCLIENT C, PCUSUARI U, PCSUPERV S, PCATIVI I#(lf)WHERE#(lf) C.CODUSUR1 = U.CODUSUR(+)#(lf) AND I.CODATIV=C.CODATV1 #(lf) AND U.CODSUPERVISOR = S.CODSUPERVISOR#(lf) AND C.DTEXCLUSAO IS NULL#(lf) #(lf)UNION ALL#(lf)#(lf)SELECT#(lf) C.CODCLI AS CODCLI,#(lf) C.CLIENTE,#(lf) --C.CEPENT AS CEP,#(lf) --C.ENDERENT AS ENDERECO,#(lf) --C.BAIRROENT AS BAIRRO,#(lf) C.MUNICENT AS MUNICIPIO,#(lf) --C.CGCENT AS CNPJ,#(lf) --C.IEENT AS IE,#(lf) C.BLOQUEIO,#(lf) C.OBS AS ""MOTIVO BLOQUEIO"",#(lf) U2.CODUSUR AS CODRCA1,#(lf) U.NOME AS RCA,#(lf) S.CODSUPERVISOR,#(lf) S.NOME AS SUPERVISOR,#(lf)-- C.FANTASIA,#(lf) I.RAMO,#(lf)-- C.LIMCRED,#(lf) C.DTULTCOMP,#(lf) C.ESTENT,#(lf) C.DTBLOQ,#(lf) C.DTCADASTRO,#(lf) --C.DTEXCLUSAO #(lf) --C.DTPRIMCOMPRA#(lf)FROM#(lf) PCCLIENT C, PCUSUARI U, PCSUPERV S, PCUSURCLI U2, PCATIVI I#(lf)WHERE#(lf) U2.CODUSUR = U.CODUSUR#(lf) AND I.CODATIV=C.CODATV1#(lf) AND U2.CODCLI=C.CODCLI#(lf) AND U.CODSUPERVISOR = S.CODSUPERVISOR#(lf) AND C.DTEXCLUSAO IS NULL #(lf) ) VALOR#(lf) #(lf)LEFT JOIN #(lf) #(lf)(SELECT #(lf)#(tab)S.codsupervisor AS COD_SUPERVISOR,#(lf) CASE WHEN S.CODSUPERVISOR IN (9111,9114,9116,9119,9121,9122,9124,9125,9131,9132,9137,9141,9142,9143,9145,9146,9147) THEN 'G.C Varejo'#(lf) WHEN S.CODSUPERVISOR IN (9135) THEN 'G.A Regionais'#(lf) WHEN S.CODSUPERVISOR IN (1) THEN 'G.A Atacado'#(lf) WHEN S.CODSUPERVISOR IN (9107) THEN 'G.A Unipar'#(lf) ELSE 'Outros' END AS Gerencia#(lf) #(lf)FROM PCSUPERV S) GERENCIA #(lf)ON GERENCIA.COD_SUPERVISOR = VALOR.CODSUPERVISOR#(lf)#(lf)WHERE VALOR.SUPERVISOR LIKE '%EQUIPE%'#(lf)AND VALOR.CODSUPERVISOR NOT IN #(lf)(9140,9136,9123,9133,9130)"
<br><br>    #<font color="red">"Texto em Maiúscula"</font> = <font color="purple">Table.TransformColumns</font>(<font color="red">Fonte</font>,{{<font color="red">"MUNICIPIO"</font>, <font color="purple">Text.Upper</font>, <font color="blue">type</font> <font color="blue">text</font>}}),<br><br>    #<font color="red">"Texto Aparado"</font> = <font color="purple">Table.TransformColumns</font>(#<font color="red">"Texto em Maiúscula"</font>,{{<font color="red">"MUNICIPIO"</font>, <font color="purple">Text.Trim</font>, <font color="blue">type</font> <font color="blue">text</font>}}),<br><br>    #<font color="red">"Tipo Alterado"</font> = <font color="purple">Table.TransformColumnTypes</font>(#<font color="red">"Texto Aparado"</font>,{{<font color="red">"DTCADASTRO"</font>, <font color="blue">type</font> <font color="blue">date</font>},  
{<font color="red">"DTULTCOMP"</font>, <font color="blue">type</font> <font color="blue">date</font>}, {<font color="red">"DTBLOQ"</font>, <font color="blue">type</font> <font color="blue">date</font>}})<br><br><font color="blue">in</font><br><br>    #<font color="red">"Tipo Alterado"</font></td></tr><tr><td>dim Customer Type-14a36730-5411-4c20-8827-602cf105a4c3</td><td><font color="blue">let</font><br><br>    Fonte = <font color="purple">Table.FromRows</font>(<font color="purple">Json.Document</font>(<font color="purple">Binary.Decompress</font>(<font color="purple">Binary.From</font>Text("i45W8kksLlEwUvDNL1bSUTJSitWBChlDhYwRQmZQIROwkCFQU2pxKkjAFCwQkpFZDFSRV5IBFDIEC2nD9ZgpxcYCAA=="", <font color="purple">BinaryEncoding.Base64</font>), <font color="purple">Compression.Deflate</font>)), <font color="blue">let</font> _t = ((<font color="blue">type</font> nullable <font color="blue">text</font>) meta [Serialized.Text = <font color="blue">true</font>]) <font color="blue">in</font> <font color="blue">type</font> table [#<font color="red">"Tipo de Cliente"</font> = _t, #<font color="red">"Sort Order"</font> = _t]),<br><br>    #<font color="red">"Colunas Renomeadas"</font> = <font color="purple">Table.RenameColumns</font>(Fonte,{{<font color="red">"Tipo de Cliente"</font>, <font color="red">"Tipos de Cliente"</font>}})<br><br><font color="blue">in</font><br><br>    #<font color="red">"Colunas Renomeadas"</font></td></tr></tbody>
      </table>
      <script>
         var toggler = document.getElementsByClassName("caret");
         for (var i = 0; i < toggler.length; i++){
         	toggler[i].addEventListener("click", function() {
         		this.parentElement.querySelector(".nested").classList.toggle("active");
         	});
         }
         	
         var togglerAll = document.getElementsByClassName("dropDownCaret");
         for (var j=0; j<togglerAll.length; j++){
         	togglerAll[j].addEventListener("click", function(event){
         		if (event.currentTarget != event.target) return;
         		if(this.parentElement.querySelector(".nested").classList.contains("active")){
         			this.querySelectorAll(".nested").forEach(function(currentValue, currentIndex, listObj) {
         				if(currentValue.classList.contains("active")){
         					currentValue.classList.remove("active");
         				}
         			});
         		}
         		else{
         			this.querySelectorAll(".nested").forEach(function(currentValue, currentIndex, listObj) {
         				if(!currentValue.classList.contains("active")){
         					currentValue.classList.add("active");
         				}
         			});
         		}
         	});
         }
      </script>
   
</body></html>